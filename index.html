<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@11.0.1/lib/marked.umd.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="index.css" />
  <link rel="shortcut icon" href="bakabakaband.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="bakabakaband180.png" />
  <link rel="icon" type="image/png" href="bakabakaband256.png" />

  <title>馬鹿馬鹿蛮怒</title>
</head>
<script>
  $(function () {
    $("#malkor-message-open").on("click", function () {
      $("#popup-bg").fadeIn();
      $("#malkor-message").fadeIn();
      scrollTo(0, 0);
      return false;
    });
    $("#malkor-message").on("click", function () {
      $("#popup-bg").fadeOut();
      $("#malkor-message").fadeOut();
      return true;
    });
    $("#malkor-message-close2").on("click", function () {
      $("#popup-bg").fadeOut();
      $("#malkor-message").fadeOut();
      return false;
    });
    $("#damnya-open").on("click", function () {
      $("#popup-bg").fadeIn();
      $("#damnya").fadeIn();
      scrollTo(0, 0);
      return false;
    });
    $("#damnya").on("click", function () {
      $("#popup-bg").fadeOut();
      $("#damnya").fadeOut();
      return false;
    });
    $("#194powers-open").on("click", function () {
      $("#popup-bg").fadeIn();
      $("#194powers").fadeIn();
      scrollTo(0, 0);
      return false;
    });
    $("#194powers").on("click", function () {
      $("#popup-bg").fadeOut();
      $("#194powers").fadeOut();
      return false;
    });
    $("#article-open").on("click", function () {
      $("#popup-bg").fadeIn();
      $("#article").fadeIn();
      scrollTo(0, 0);
      return false;
    });
    $("#article").on("click", function () {
      $("#popup-bg").fadeOut();
      $("#article").fadeOut();
      return true;
    });
  });



</script>
</head>

<body>
  <div id="popup-bg"></div>

  <div id="app">

    <div class="modal fade" id="melkorLetterModal" tabindex="-1" aria-labelledby="melkorLetterModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="melkorLetterModalLabel">aaaaaa</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
          </div>
          <div class="modal-body">
            AAAAAA
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <h1 class="copy">{{text}}</h1>

    <div class="popup-contents" id="malkor-message">
      <article id="malkor-article">
        <img class="melkor-symbol" src="Melkor-Symbol.png" />
        <div v-html="updateMelkorLetter"></div>
      </article>
    </div>

    <div class="popup-contents" id="damnya">
      <img id="ahona" src="damnya.jpg" />
    </div>

    <div class="popup-contents" id="194powers">
      <img id="ahona" src="194powers.jpg" />
    </div>

    <div class="popup-contents" id="article">
      <div v-html="articleLetter"></div>
    </div>

    <div id="visual">
      <img id="melko" src="Melko.png" />
      <div id="title-div">
        <img id="title" src="BakabakabandTitle.png" />
      </div>
    </div>

    <div id="article-list" v-html="articleList">
    </div>

    <div id="flex-box">
      <div id="top-message" v-html="updateList">
      </div>
      <div id="menu-block">
        <div class="container mt-5" style="z-index:100;">
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#melkorLetterModal">
            冥王の書簡
          </button>
        </div>

        <a class="button-link" href="#Melkor">
          <div class="button">
            <img class="select-icon" src="mel-icon.png" />冥王の書簡
          </div>
        </a>
        <a class="button-link"
          href="https://github.com/sikabane-works/bakabakaband/releases/download/0.0.0.60-Alpha/Bakabakaband-0.0.0.60-Alpha-jp.zip">
          <div class="button">
            <img class="select-icon" src="download.png" />ダウンロード(0.0.0.60-Alpha)
          </div>
        </a>
        <a class="button-link" href="https://github.com/sikabane-works/bakabakaband/releases/">
          <div class="button">
            <img class="select-icon" src="bakabaka-icon.png" />変愚からの更新要素
          </div>
        </a>
        <a class="button-link" href="https://github.com/sikabane-works/bakabakaband#readme">
          <div class="button">
            <img class="select-icon" src="nasty.png" />馬鹿馬鹿はここが絶望的に汚い
          </div>
        </a>
        <a class="button-link" href="https://hengband.github.io/">
          <div class="button">
            <img class="select-icon" src="hengband.png" />アホ臭いので変愚へ飛ぶ
          </div>
        </a>
      </div>
    </div>

  </div>

</body>

</html>

<script>
  new Vue({
    el: "#app",
    data() {
      return {
        text: "この門をくぐる者は一切の良識を捨てよ",
        updateText: "",
        currentAnchor: "",
        melkorLetter: "",
        articleLetter: "",
        articleListText: ""
      }
    },
    mounted() {
      this.getCurrentAnchor();
      window.addEventListener('hashchange', this.getCurrentAnchor);
    },
    methods: {
      getCurrentAnchor() {
        this.currentAnchor = window.location.hash.substring(1);
        if (this.currentAnchor == "Melkor") {
          this.updateMelkorLetter;
          $("#popup-bg").fadeIn();
          $("#malkor-message").fadeIn();
          scrollTo(0, 0);
        }
        var code = this.currentAnchor.split('-');
        if (code[0] == "article") {
          this.updateArticle(code[1]);
          $("#popup-bg").fadeIn();
          $("#article").fadeIn();
          scrollTo(0, 0);
        }
      },
      updateArticle(article) {
        var self = this;
        var path = `./document/article-${article}.html`;
        console.log(path);
        axios.get(path)
          .then(function (response) {
            self.articleLetter = response.data;
          })
          .catch(function (error) {
            self.articleLetter = "[ERROR]"
          });
        return self.articleLetter;
      }
    },
    beforeDestroy() {
      window.removeEventListener('hashchange', this.getCurrentAnchor);
    },
    computed: {
      articleList() {
        var self = this;
        axios.get("./document/list.html")
          .then(function (response) {
            self.articleListText = response.data;
          })
          .catch(function (error) {
            self.articleListText = "[ERROR]"
          });
        return self.articleListText;
      },
      updateList() {
        var self = this;
        axios.get("./update/update.html")
          .then(function (response) {
            self.updateText = response.data;
          })
          .catch(function (error) {
            self.updateText = "[ERROR]"
          });
        return self.updateText;
      },
      updateMelkorLetter() {
        /*
        var self = this;
        axios.get("./document/melkor.html")
          .then(function (response) {
            self.melkorLetter = response.data;
          })
          .catch(function (error) {
            self.melkorLetter = "[ERROR]"
          });
        return self.melkorLetter;
        */
      }
    }
  }
  );
</script>